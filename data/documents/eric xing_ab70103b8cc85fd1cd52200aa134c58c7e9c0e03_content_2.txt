Title: FedNAR: Federated Optimization with Normalized Annealing Regularization
Authors: Junbo Li, Ang Li, Chong Tian, Qirong Ho, Eric P. Xing, Hongyi Wang
Section: B Supplementary proofs
≤ 2σ2 + 2L2E∥xt,ij − x t−1∥2 = 2σ2 + 2L2E ∥∥∥∥∥ j∑ r=1 ξt(g t,i r−1, x t,i r−1) ∥∥∥∥∥ 2 = 2σ2 + 2L2jE j∑ r=1 ∥∥∥ξt(gt,ir−1, xt,ir−1)∥∥∥2 ≤ 2σ2 + 2L2j2A2 ≤ 2σ2 + 2L2τ2A2, (8) where we use Assumption 2 and 1 in the second inequality. Substituting 8 into 7, we have 1 M M∑ i=1 E∥ht,i −∇Fi(xt−1)∥2 ≤ 2 M M∑ i=1 τ−1∑ j=0 ∥∥∥gt,ij −∇Fi(xt−1)∥∥∥2 ≤ 2 M M∑ i=1 τ ( 2σ2 + 2L2τ2A2 ) = 4τσ2 + 4L2τ2A3. (9) Taking D = 4τσ2 + 4L2τ2A3 finishes the proof. B.2.2 Proof of main theorem Now we can prove Theorem 2. Theorem 2. Under Assumptions 1, 2 and 3, if λt and µt satisfy the condition in Theorem 1, and also if there exists {ut} with an exponential decay speed, such that for any t ≥ 0, and any g, x ∈ Rd, µt(g, x) ≤ ut, then the global model {xt} satisfies: min 1≤t≤T E∥∇F (xt)∥2 ≤ O ( 1 T ) +O Lλ2gτ2C2︸ ︷︷ ︸ weight decay error +Lλ2gτ l 2 ∗(τσ 2 + L2τ2A3 + σ2g)︸ ︷︷ ︸ client drift and data heterogeneity error , where l∗ = maxt{lt}, with lt = maxg,x{λt(g, x)}, and C satisfies ut∥xt∥, ut∥xt∥2 ≤ C for any t. Proof. By Lemma 1, xt = xt−1 − ( λgh t + µt−1g x t−1) . Under Assumption 1 (L-smooth), we have F (xt)− F (xt−1) ≤ −⟨∇F (xt−1), λght + µt−1g xt−1⟩+ L 2 ∥∥λght + µt−1g xt−1∥∥2 ≤ −⟨∇F (xt−1), λght⟩︸ ︷︷ ︸ T1 −⟨∇F (xt−1), µt−1g xt−1⟩︸ ︷︷ ︸ T2 +Lλ2g∥ht∥2︸ ︷︷ ︸ T3 +Lµt−1g 2∥xt−1∥2︸ ︷︷ ︸ T4 . We bound these four terms successively. We have T1 = −λg 〈 ∇F (xt−1), 1 M M∑ i=1 βt,iht,i 〉 = −λg 1 M M∑ i=1 βt,i⟨∇F (xt−1), ht,i⟩ ≤ −λg 1 2M M∑ i=1 βt,i ( ∥∇F (xt−1)∥2 − ∥∥∇F (xt−1)− ht,i∥∥) = − λg 2M ∥∥∇F (xt−1)∥∥2 M∑ i=1 βt,i + λg 2M M∑ i=1 βt,i ∥∥∇F (xt−1)− ht,i∥∥ ≤ − λg 2M ∥∥∇F (xt−1)∥∥2 M∑ i=1 βt,i + λg 2M M∑ i=1 βt,i∥∇Fi(xt−1)− ht,i∥2 + λg 2M M∑ i=1 βt,i∥∇F (xt−1)−∇Fi(xt−1)∥2 ≤ − λg 2M ∥∥∇F (xt−1)∥∥2 M∑ i=1 βt,i + λgτ l∗ 2M M∑ i=1 ∥∇Fi(xt−1)− ht,i∥2 + λg 2 τ l∗σ 2 g , (10) where we use 2⟨a, b⟩ ≥ ∥a∥2 − ∥a − b∥2 in the first inequality and use Assumption 3 in the last inequality. T2 = −⟨∇F (xt−1), µt−1g xt−1⟩ (11) ≤ µt−1g 2 ∥∇F