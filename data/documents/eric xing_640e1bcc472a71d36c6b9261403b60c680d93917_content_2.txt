Title: GET: a foundation model of transcription across human cell types
Authors: Xi Fu, Shentong Mo, Anqi Shao, Anouchka Laurent, Alejandro Buendia, Adolfo A. Ferrando, Alberto Ciccia, Yanyan Lan, Teresa Palomero, David M. Owens, Eric P. Xing, Raul Rabadan
Section: Methods
in line with our existing data preprocessing pipeline, we selected 200 as the quantity of input regions for a single training sample. Non-overlapping samples were extracted from the genome for pretraining, and exclusively from training chromosomes for the finetuning phase. RNA-seq Data Processing Cell Type Matching For experiments encompassing multiomics, the correspondence between accessibility and expression is inherently determined through cell barcodes. In pseudobulk cases, where accessibility and expression are assessed independently, cell type annotations are utilized to facilitate the mapping. Specifically, the fetal expression atlas from Cao et al.6 is employed for fetal cell types, while adult data is extracted from Tabula Sapiens7. When several ATAC pseudobulk share the same cell type annotation, identical expression labels are assigned. This approach, while a compromise, is necessitated by the current dearth of multiome sequencing data, a situation expected to change dramatically in the near future. Expression Values Expression values are allocated to each region within our input. Constrained by poly-A scRNA-seq, only aggregated mRNA levels can be captured, resulting in values that are not reflective of the nascent transcription rate more closely tied to regulatory events. Nonetheless, these values furnish valuable cell-type-specific information. The process begins by intersecting the input region list with Gencode V40 transcripts annotation to pinpoint promoters, followed by the assignment of log count per million (CPM) values to regions corresponding to these promoters. All remaining regions are assigned a value of 0. Although this does not perfectly represent all transcription events happening in a cell, we believe the zero label on non-promoter region helps in delivering informative negative labels to the model. Input Target In alignment with the 200⇥283 input matrix, the target input is a 200⇥2 matrix, symbolizing the transcription levels of the corresponding 200 regions across both positive and negative strands. Model architecture The GET architecture consists of three parts: 1) A regulatory element (RE) embedding layer, 2) 12 RE-wise attention layers, and 3) a linear layer as the expression prediction head (Supplementary Figure 1). Our GET takes 200 regulatory elements, each with 282 motif binding scores and optionally one accessibility score as a sample as the input. As a result, the input is a 200⇥283 matrix. When we choose to not using the quantitative accessibility score, we set the 283-th column to 1. Then we feed the sample into the RE embedding layer to generate the regulatory element embedding with a dimension of 768 for each peak. Since we do not want to lose information in the input of the original regulatory element, we