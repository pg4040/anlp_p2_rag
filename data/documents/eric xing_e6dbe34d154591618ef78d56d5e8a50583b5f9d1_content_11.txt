Title: Contextualized Networks Reveal Heterogeneous Transcriptomic Regulation in Tumors at Sample-Specific Resolution
Authors: Caleb N. Ellington, Benjamin J. Lengerich, Thomas B.K. Watkins, Jiekun Yang, Manolis Kellis, Eric P. Xing
Section: 
= Σ−1 and estimate pairwise partial correlation290 coefficients. Using an equivalence defined by Peng et al. [55], the partial correlation coefficient is defined by regression291 as292 ρij = sign(βij) √ βijβji = − ωij ωiiωjj Where the precision matrix Ω has elements ωij and β is the ordinary least squares solution to multivariate linear293 regression βi = argminβ ∥Xi −X−iβ∥ 2 2. Critically, the precision matrix directly encodes conditional independence294 between features in X , and thus precision encodes the Markov network.295 ωij = 0 ⇐⇒ Xi ⊥Xj ∣X−{i,j} Following [56], we assume constant diagonal precision wii = wjj∀i, j and therefore achieve proportionality between296 the regression and the precision matrix.297 ωij ∝ − sign(β̂ij) √ β̂ij β̂ji Assuming unit diagonal precisions ωii = 1, the proportionality becomes exact equivalence. Further, proportionality298 induces symmetry in the regression, i.e. βij = βji. We encode this in the objective by requiring our estimate for θ to299 be a symmetrically augmented matrix based on γ, i.e. β = γ + γT300 γ̂ = argmin γ ∥X −X(γ + γT )∥2F s.t. diag(γ) = [0] If Ω is sparse, we can apply lasso regularization to the multivariate regression objective [54]. Given the similarity301 between this differential Markov network objective and the neighborhood regression objective, we follow the exact302 contextualization procedure from above to contextualize γ and arrive at a loss function ℓMN303 ℓMN(ϕ(C; f,A),X) = ∥X −X(ϕ ′ (C; f,A) + ϕ′(C; f,A)T )∥22 + λ∑ i ∥ϕ′(C; f,A)i∥1 where ϕ′ is defined identically for masking the diagonal. The resulting precision matrix estimate is Ω̂ = −(ϕ′(C; f̂ , Â)+304 ϕ′(C; f̂ , Â)T ). In practice we do not threshold the estimated precision to non-zero values, instead using the exact pre-305 cision matrix to represent the Markov network, retaining information about dependency strength as well as dependency306 structure in the network.307 13 Contextualized Correlation Networks308 Correlation networks are simple to estimate and often state-of-the-art for gene regulatory network inference [27];309 contextualized correlation expand this utility to the granularity of sample-specific network inferences. To estimate310 sample-specific correlation networks, we assume the data was drawn from X ∼ N(0,Σ) and use the well known311 univariable regression view of Pearson’s marginal correlation coefficient:312 ρ2ij = σij σiiσjj = βijβji where the covariance matrix Σ has elements σij , and βij = argminβ(Xj −Xiβ) 2. This form converts correlation into313 two separable univariate least-squares regressions that maximize the marginal conditional probabilities P (Xi∣Xj) and314 P (Xj ∣Xi). Contextualizing this differentiable objective, we get the contextualized correlation network