Title: GET: a foundation model of transcription across human cell types
Authors: Xi Fu, Shentong Mo, Anqi Shao, Anouchka Laurent, Alejandro Buendia, Adolfo A. Ferrando, Alberto Ciccia, Yanyan Lan, Teresa Palomero, David M. Owens, Eric P. Xing, Raul Rabadan
Section: Methods
chromatin accessibility-gene expression data with the same Poisson negative log-likelihood loss function as Enformer9. Expression values are represented as normalized transcript per million (TPM). We then match the cell types between RNA and ATAC datasets by annotating cell type names and ignoring those that cannot be matched. To improve training stability, we log-transform the expression values as log10(TPM+1). We then map the gene expression to accessible regions using the following approach: if a region overlaps with a gene’s transcription start site (TSS), the gene’s expression value is assigned to that region as a label; if a region overlaps with multiple gene’s TSS, the expression values of the corresponding gene are summed up and used as the label of that region; if a region does not overlap with any TSS, the corresponding expression label is set as 0. Finally, each regulatory element is assigned to an expression target value. The GET implementation is based on PyTorch10 framework. For the first training stage, we applied AdamW11 as our optimizer with a weight decay of 0.05 and a batch size of 256. The model was trained for 800 epochs with 40 warmup epochs for linear learning rate scaling. We set the maximum learning rate to 1.5e-4. For the second fine-tuning stage, we used AdamW11 as our optimizer with a weight decay of 0.05 and a batch size of 256. The model was trained for 100 epochs. Model evaluation We use pearson correlation, spearman correlation, and R2 to evaluate the prediction performance in all settings. For evaluation of cell type specific gene prediction, we compare the observed and predicted log fold change between two cell types using the same metrics. Cross-cell-type expression prediction In cross-cell-type prediction setting, we pretrained on ATAC-seq data from all cell types, and finetuned with expression data from only training cell types, hiding the evaluation cell type expression label from the model. On average, GET achieves 0.799 peasrson s r and 0.845 spearman correlation across different leave-out-cell type settings. Furthermore, GET is able to get similar performance when chromosomes (chr4,chr14) are also leaved out (cell-type & chromosome leave-out, Spearman rho: 0.938, R2: 0.868, Pearson’s r: 0.935). Platform transfer prediction In order to transfer to a new sequencing platform, there are multitude of domain shift that need to be addressed. This including but not limit to: 1. Sequencing depth: as lower depth will lead to less captured peaks. It will also affect the signal to noise ratio in the accessibility quantification; 2. Peak calling threshold and software; 3. Technical bias due