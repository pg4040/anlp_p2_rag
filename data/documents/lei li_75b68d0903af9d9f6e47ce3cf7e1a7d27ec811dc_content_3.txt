Title: Provable Robust Watermarking for AI-Generated Text
Authors: Xuandong Zhao, Prabhanjan Ananth, Lei Li, Yu-Xiang Wang
Section: C.6 Proof of Theorem C.13
is stated in Proposition C.22. Lemma C.21. Fix pt E G [(pt(G)− γ)2] ≤ γ(1− γ)∥pt[·]∥2. Proof. First observe that EG[pt(G)] = γ because every token has γ probability to be included. By the variance formula for sampling without replacement (N choose Nγ), VarG[pt(G)|y1:t−1] = γN 1 N N∑ i=1 (pt[i] 2 −N−2)(1− γN − 1 N − 1 ) ≤ γ(1− γ) N∑ i=1 pt[i] 2. Proposition C.22. Assume homophily, then E [ n∑ t=1 P yt∼p̂(·|x,y1:t−1) [yt ∈ G] ] ≥ nγ ( eδ 1 + (eδ − 1)γ − (1− γ)e δ n n∑ t=1 E y1:t−1∼p(·|x) N∑ i=1 pt[i] 2 ) . Proof. By homophily, E [ n∑ t=1 P yt∼p̂(·|x,y1:t−1) [yt ∈ G] ] = n∑ t=1 E G,y1:t−1∼p̂(·|x) [ P yt∼p̂(·|x,y1:t−1) [yt ∈ G] ] ≥ n∑ t=1 E G,y1:t−1∼p(·|x) [ P yt∼p̂(·|x,y1:t−1) [yt ∈ G] ] = n∑ t=1 E y1:t−1∼p(·|x) E G [ eδ Pyt∼pt(·|y1:t−1)[yt ∈ G] 1 + (eδ − 1)Pyt∼pt(·|y1:t−1)[yt ∈ G] ∣∣∣∣∣y1:t−1 ] (8) By Lemma C.18, we can decompose (8). Also observe that EG [ pt(G) ∣∣y1:t−1] = γ where pt(G) := Pyt∼pt(·|y1:t−1)[yt ∈ G] is short hand for clarity. To see the second observation, notice that yt is independent to G, thus we can apply Statement 1 of Theorem C.4). Apply the two observations to (8), we have (8) ≥ n∑ t=1 E y1:t−1∼p(·|x) E G [ eδγ 1 + (eδ − 1)γ + eδ(pt(G)− γ) (1 + (eδ − 1)γ)2 − eδ(pt(G)− γ)2 ∣∣∣∣y1:t−1] = eδnγ 1 + (eδ − 1)γ + n∑ t=1 E y1:t−1∼p(·|x) [ eδ(EG[pt(G)|y1:t−1]− γ) (1 + (eδ − 1)γ)2 − eδ E G [(pt(G)− γ)2|y1:t−1] ] = eδnγ 1 + (eδ − 1)γ − n∑ t=1 eδ E y1:t−1∼p(·|x) VarG[pt(G)|y1:t−1]. By the variance formula for sampling without replacement (N choose Nγ), VarG[pt(G)|y1:t−1] = γN 1 N N∑ i=1 (pt[i] 2 −N−2)(1− γN − 1 N − 1 ) ≤ γ(1− γ) N∑ i=1 pt[i] 2. Thus it follows that (8) ≥ e δnγ 1 + (eδ − 1)γ − n∑ t=1 eδ E y1:t−1∼p(·|x) γ(1− γ) N∑ i=1 pt[i] 2 = nγ ( eδ 1 + (eδ − 1)γ − (1− γ)e δ n n∑ t=1 E y1:t−1∼p(·|x) N∑ i=1 pt[i] 2 ) .